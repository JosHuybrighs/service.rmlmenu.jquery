;(function($,j,k){var l='1.0.3';$.RMLMenu=function(a,b){this.div_el=$(a);this.ul_el=$(a).children(":first");this.ul_el.find("li").css("list-style","none");this._init(b)};$.RMLMenu.prototype={_constructMenu:function(){this.curItem=false;var c=this;var d=$('li:has(ul)',this.ul_el);if((window.ontouchstart===k)&&!window.navigator.msMaxTouchPoints&&!window.navigator.userAgent.toLowerCase().match(/windows phone os 7/i)){}else{d.on('click',function(e){var a=false;var b=$(this);if(b[0]!==c.curItem[0]){c.curItem=b;a=true}});$(document).on('click touchstart MSPointerDown',function(e){var a=true;var b=$(e.target).parents();for(i=0;i<b.length;i++){if(b[i]===c.curItem[0]){a=false;break}}if(a){c.curItem=false}})}this.div_el.show()},_destructMenu:function(){if((window.ontouchstart===k)&&!window.navigator.msMaxTouchPoints&&!window.navigator.userAgent.toLowerCase().match(/windows phone os 7/i)){return}$(document).off();var a=this.ul_el.find('li');a.off()},_openPopupMenu:function(){var a=this;this.div_el.show();this.isOpen=true;$('html').on('click',function(){if(a.isOpen){a._closePopupMenu()}});this.settings.onPopupMenuOpen()},_closePopupMenu:function(){this.settings.onPopupMenuClose();this.div_el.hide();this.isOpen=false;this.ul_el.removeClass('dl-subview');this.menuitems.removeClass('dl-subview dl-subviewopen');$('html').off()},_constructPopupMenu:function(){var f=this;this.div_el.hide();this.isOpen=false;this.div_el.addClass('rmlPopupPanel');this.div_el.prepend('<h3 class="rmlMenuText">'+this.settings.pMenuTitle+'</h3>');this.menuTitleEl=this.div_el.find('h3:first');this.menuTitleEl.ontouchclick(function(e){if(f.isOpen){f._closePopupMenu()}});this.menuitems=this.ul_el.find('li');var g=this.ul_el.find('ul');g.prepend('<li class="rmlm-back"><a href="#">'+this.settings.pMenuBackText+'</a></li>');this.back=g.find('li:first');this.back.ontouchclick(function(a){if(f.isOpen){$this=$(a.currentTarget);var b=$this.parents('ul:first');var c=b.parent();c.removeClass('dl-subviewopen');var d=$this.parents('.dl-subview:first');if(d.is('li')){d.addClass('dl-subviewopen')}d.removeClass('dl-subview')}});this.menuitems.ontouchclick(function(a){if(f.isOpen){var b=$(a.currentTarget);var c=b.children('ul');if(c.length>0){f.ul_el.addClass('dl-subview');b.addClass('dl-subviewopen').parents('.dl-subviewopen:first').removeClass('dl-subviewopen').addClass('dl-subview');f.settings.onLevelClick(b,b.children('a:first').text())}else{isHandled=f.settings.onLinkClick(b,a);if(!isHandled){var d=b.find('a:first');var e=d.attr('href');location.href=e}if(b.data('keep-menu-open')==k){f._closePopupMenu()}}}});this.div_el.on('click',function(a){if(f.isOpen){a.stopPropagation()}})},_destroyPopupMenu:function(){if(this.isOpen){this._closePopupMenu()}this.div_el.off();this.menuitems.off();this.menuitems=[];this.back.off();$.each(this.back,function(i,a){$(a).remove()});this.back=[];this.menuTitleEl.off();this.menuTitleEl.remove();this.div_el.removeClass('rmlPopupPanel');this.div_el.show()},_init:function(c){var d=this;var f={pMenuBttn:'#popupMenuBttn',pMenuBackText:'Back',pMenuTitle:'Menu',onLevelClick:function(a,b){return false},onLinkClick:function(a,b){return false},onPopupMenuOpen:function(){return false},onPopupMenuClose:function(){return false},onTrace:function(a){return false},};this.settings=$.extend(f,c||{});var g=!$(d.settings.pMenuBttn).is(':visible');this.ul_el.attr('class',g?'rmlmenu':'rmlpopupmenu');if(!g){this._constructPopupMenu()}else{this._constructMenu()}var h=$(this.settings.pMenuBttn);h.ontouchclick(function(e){if(!d.isOpen){d._openPopupMenu()}else{d._closePopupMenu()}});$(window).resize(function(){var a=!$(d.settings.pMenuBttn).is(':visible');if(a!=g){g=a;d.ul_el.attr('class',g?'rmlmenu':'rmlpopupmenu');if(g){d._destroyPopupMenu();d._constructMenu()}else{d._destructMenu();d._constructPopupMenu()}}})}};$.fn.rmlmenu=function(b){return this.each(function(){if($(this).data('rmlmenu-plugin'))return;var a=new $.RMLMenu(this,b);$(this).data('rmlmenu-plugin',a)})}})(jQuery);